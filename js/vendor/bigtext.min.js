(function(f,d){function r(a,b,c,d,l,e,h){h="number"==typeof h?h:0;a.css(c,d+e);e=a.width();if(e>=b){a.css(c,"");if(e==b)return{match:"exact",size:parseFloat((parseFloat(d)-0.1).toFixed(3))};a=b-h;b=e-b;return{match:"estimate",size:parseFloat((parseFloat(d)-("word-spacing"===c&&h&&b<a?0:l)).toFixed(3))}}return e}function s(a,b,m,g,l){a=a.clone(!0).addClass("bigtext-cloned").css({fontFamily:a.css("font-family"),textTransform:a.css("text-transform"),wordSpacing:a.css("word-spacing"),letterSpacing:a.css("letter-spacing"),
position:"absolute",left:c.DEBUG_MODE?0:-9999,top:c.DEBUG_MODE?0:-9999}).appendTo(document.body);var e=[],h=[],f=[],q=[];b.css("float","left").each(function(a){a=d(this);var b=c.test.noFractionalFontSize?[8,4,1]:[8,4,1,0.1],h;if(a.hasClass(c.EXEMPT_CLASS))e.push(null),q.push(null),f.push(!1);else{var k=parseFloat(a.css("font-size")),k=(a.width()/k).toFixed(6);newFontSize=parseInt(m/k,10)-32;var k=0,p=b.length;a:for(;k<p;k++){var n=1;b:for(;10>=n;n++){if(newFontSize+n*b[k]>g){newFontSize=g;break a}h=
r(a,m,"font-size",newFontSize+n*b[k],b[k],"px",h);if("number"!==typeof h){newFontSize=h.size;if("exact"==h.match)break a;break b}}}q.push(m/newFontSize);newFontSize>g?(e.push(g),f.push(!1)):l&&newFontSize<l?(e.push(l),f.push(!0)):(e.push(newFontSize),f.push(!1))}}).each(function(a){var b=d(this),g=0,k;if(b.hasClass(c.EXEMPT_CLASS))h.push(null);else{b.css("font-size",e[a]+"px");for(a=1;3>a;a+=1)if(k=r(b,m,"word-spacing",a,1,"px",k),"number"!==typeof k){g=k.size;break}b.css("font-size","");h.push(g)}}).removeAttr("style");
c.DEBUG_MODE?a.css({"background-color":"rgba(255,255,255,.4)"}):a.remove();return{fontSizes:e,wordSpacings:h,ratios:q,minFontSizes:f}}var t=0,p=d("head"),u=f.BigText,v=d.fn.bigtext,c={DEBUG_MODE:!1,DEFAULT_MIN_FONT_SIZE_PX:null,DEFAULT_MAX_FONT_SIZE_PX:528,GLOBAL_STYLE_ID:"bigtext-style",STYLE_ID:"bigtext-id",LINE_CLASS_PREFIX:"bigtext-line",EXEMPT_CLASS:"bigtext-exempt",noConflict:function(a){a&&(d.fn.bigtext=v,f.BigText=u);return c},test:{noFractionalFontSize:function(){if(!("getComputedStyle"in
f&&"body"in document))return!0;var a=d("<div/>").css({position:"absolute","font-size":"14.1px"}).appendTo(document.body).get(0);return(a=f.getComputedStyle(a,null))?"14px"===a.getPropertyValue("font-size"):!0}()},init:function(){d("#"+c.GLOBAL_STYLE_ID).length||p.append(c.generateStyleTag(c.GLOBAL_STYLE_ID,[".bigtext * { white-space: nowrap; } .bigtext > * { display: block; }",".bigtext ."+c.EXEMPT_CLASS+", .bigtext ."+c.EXEMPT_CLASS+" * { white-space: normal; }"]))},bindResize:function(a,b){d.throttle?
d(f).unbind(a).bind(a,d.throttle(100,b)):(d.fn.smartresize?a="smartresize."+a:_.debounce&&(b=_.debounce(b,200)),d(f).unbind(a).bind(a,b))},getStyleId:function(a){return c.STYLE_ID+"-"+a},generateStyleTag:function(a,b){return d("<style>"+b.join("\n")+"</style>").attr("id",a)},clearCss:function(a){a=c.getStyleId(a);d("#"+a).remove()},generateCss:function(a,b,d,g){var f=[];c.clearCss(a);for(var e=0,h=b.length;e<h;e++)f.push("#"+a+" ."+c.LINE_CLASS_PREFIX+e+" {"+(g[e]?" white-space: normal;":"")+(b[e]?
" font-size: "+b[e]+"px;":"")+(d[e]?" word-spacing: "+d[e]+"px;":"")+"}");return c.generateStyleTag(c.getStyleId(a),f)},jQueryMethod:function(a){c.init();a=d.extend({minfontsize:c.DEFAULT_MIN_FONT_SIZE_PX,maxfontsize:c.DEFAULT_MAX_FONT_SIZE_PX,childSelector:"",resize:!0},a||{});this.each(function(){var b=d(this).addClass("bigtext"),f=b.width(),g=b.attr("id"),l=a.childSelector?b.find(a.childSelector):b.children();g||(g="bigtext-id"+t++,b.attr("id",g));a.resize&&c.bindResize("resize.bigtext-event-"+
g,function(){c.jQueryMethod.call(d("#"+g),a)});c.clearCss(g);l.addClass(function(a,b){return[b.replace(RegExp("\\b"+c.LINE_CLASS_PREFIX+"\\d+\\b"),""),c.LINE_CLASS_PREFIX+a].join(" ")});b=s(b,l,f,a.maxfontsize,a.minfontsize);p.append(c.generateCss(g,b.fontSizes,b.wordSpacings,b.minFontSizes))});return this.trigger("bigtext:complete")}};d.fn.bigtext=c.jQueryMethod;f.BigText=c})(this,jQuery);
